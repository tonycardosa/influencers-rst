<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= typeof title !== 'undefined' ? title + ' | ' : '' %>RST Ferramentas</title>
    <link rel="icon" href="https://rstferramentas.com/img/favicon.ico" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              rstred: '#e30613',
              rstgray: '#333333',
            },
          },
        },
      };
    </script>
  </head>
  <body class="min-h-screen bg-gray-50 text-rstgray">
    <header class="bg-white shadow">
      <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-4 sm:px-6 lg:px-8">
        <div class="flex items-center gap-4">
          <a href="/dashboard" class="flex items-center gap-2">
            <img src="<%= layoutLogo %>" alt="RST Ferramentas" class="h-12 w-auto" />
            <div class="text-sm font-semibold uppercase tracking-wide text-rstgray">
              Gestão de Afiliados
            </div>
          </a>
        </div>
        <div class="flex items-center gap-4 text-sm">
          <% if (currentUser && currentUser.id) { %>
            <div class="text-right leading-tight">
              <div class="font-semibold"><%= currentUser.name %></div>
              <div class="text-xs uppercase text-gray-500"><%= currentUser.role %></div>
            </div>
            <a href="/logout" class="rounded bg-rstred px-3 py-2 text-xs font-semibold uppercase tracking-wide text-white">Terminar sessão</a>
          <% } %>
        </div>
      </div>
      <% if (currentUser && currentUser.role === 'admin') { %>
        <nav class="bg-rstgray">
          <div class="mx-auto flex max-w-7xl flex-wrap gap-4 px-4 py-2 text-sm text-white sm:px-6 lg:px-8">
            <a href="/dashboard" class="hover:text-rstred">Dashboard</a>
            <a href="/admin/influencers" class="hover:text-rstred">Afiliados</a>
            <a href="/admin/brands" class="hover:text-rstred">Marcas</a>
            <a href="/admin/rules" class="hover:text-rstred">Regras</a>
            <a href="/admin/payouts" class="hover:text-rstred">Pagamentos</a>
          </div>
        </nav>
      <% } else if (currentUser && currentUser.role === 'influencer') { %>
        <nav class="bg-rstgray">
          <div class="mx-auto flex max-w-7xl flex-wrap gap-4 px-4 py-2 text-sm text-white sm:px-6 lg:px-8">
            <a href="/dashboard" class="hover:text-rstred">Resumo</a>
            <a href="/reports/commissions" class="hover:text-rstred">Comissões</a>
            <a href="/reports/rules" class="hover:text-rstred">Regras</a>
          </div>
        </nav>
      <% } %>
    </header>

    <main class="mx-auto w-full max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
      <%- include('partials/flash') %>
      <%- body %>
    </main>

    <footer class="bg-white">
      <div class="mx-auto max-w-7xl px-4 py-6 text-center text-xs text-gray-500 sm:px-6 lg:px-8">
        &copy; <%= new Date().getFullYear() %> RST Ferramentas. Todos os direitos reservados.
      </div>
    </footer>
  </body>
</html>
